[
  {
    "id": "perm_comp_001",
    "category": "permissions",
    "subcategory": "chmod_octal_recursive",
    "instruction": "Recursively set directories to 755 and files to 644",
    "linux": "find . -type d -exec chmod 755 {} \\; && find . -type f -exec chmod 644 {} \\;",
    "windows_cmd": "icacls * /grant:r Everyone:(OI)(CI)RX /t",
    "mac": "find . -type d -exec chmod 755 {} \\; && find . -type f -exec chmod 644 {} \\;",
    "difficulty": "advanced",
    "tags": [
      "chmod",
      "recursive",
      "find"
    ]
  },
  {
    "id": "perm_comp_002",
    "category": "permissions",
    "subcategory": "chown_user_group",
    "instruction": "Change owner to 'www-data' and group to 'www-data' recursively",
    "linux": "chown -R www-data:www-data /var/www/html",
    "windows_cmd": "icacls C:\\inetpub\\wwwroot /setowner www-data /t",
    "mac": "chown -R www-data:www-data /var/www/html",
    "difficulty": "intermediate",
    "tags": [
      "chown",
      "recursive",
      "group"
    ]
  },
  {
    "id": "perm_comp_003",
    "category": "permissions",
    "subcategory": "suid",
    "instruction": "Set the SUID bit on 'script.sh'",
    "linux": "chmod u+s script.sh",
    "windows_cmd": "echo Windows does not have SUID bit.",
    "mac": "chmod u+s script.sh",
    "difficulty": "advanced",
    "tags": [
      "chmod",
      "suid",
      "special"
    ]
  },
  {
    "id": "perm_comp_004",
    "category": "permissions",
    "subcategory": "sgid",
    "instruction": "Set the SGID bit on directory 'shared'",
    "linux": "chmod g+s shared",
    "windows_cmd": "echo Windows inherits permissions automatically.",
    "mac": "chmod g+s shared",
    "difficulty": "advanced",
    "tags": [
      "chmod",
      "sgid",
      "directory"
    ]
  },
  {
    "id": "perm_comp_005",
    "category": "permissions",
    "subcategory": "sticky_bit",
    "instruction": "Set the sticky bit on directory '/tmp/public'",
    "linux": "chmod +t /tmp/public",
    "windows_cmd": "echo Windows does not have sticky bit.",
    "mac": "chmod +t /tmp/public",
    "difficulty": "advanced",
    "tags": [
      "chmod",
      "sticky",
      "tmp"
    ]
  },
  {
    "id": "perm_comp_006",
    "category": "permissions",
    "subcategory": "acl_set",
    "instruction": "Grant user 'john' read/write access to 'file.txt' using ACL",
    "linux": "setfacl -m u:john:rw file.txt",
    "windows_cmd": "icacls file.txt /grant john:(R,W)",
    "mac": "chmod +a \"john allow read,write\" file.txt",
    "difficulty": "advanced",
    "tags": [
      "acl",
      "permissions",
      "user"
    ]
  },
  {
    "id": "perm_comp_007",
    "category": "permissions",
    "subcategory": "acl_remove",
    "instruction": "Remove all ACL entries for user 'john' on 'file.txt'",
    "linux": "setfacl -x u:john file.txt",
    "windows_cmd": "icacls file.txt /remove john",
    "mac": "chmod -a \"john allow read,write\" file.txt",
    "difficulty": "advanced",
    "tags": [
      "acl",
      "remove",
      "permissions"
    ]
  },
  {
    "id": "perm_comp_008",
    "category": "permissions",
    "subcategory": "acl_view",
    "instruction": "View ACLs for 'file.txt'",
    "linux": "getfacl file.txt",
    "windows_cmd": "icacls file.txt",
    "mac": "ls -le file.txt",
    "difficulty": "intermediate",
    "tags": [
      "acl",
      "view",
      "getfacl"
    ]
  },
  {
    "id": "perm_comp_009",
    "category": "permissions",
    "subcategory": "umask",
    "instruction": "Set default file creation permissions to 644 (umask 022)",
    "linux": "umask 022",
    "windows_cmd": "echo Windows does not use umask.",
    "mac": "umask 022",
    "difficulty": "intermediate",
    "tags": [
      "umask",
      "default",
      "config"
    ]
  },
  {
    "id": "perm_comp_011",
    "category": "permissions",
    "subcategory": "chattr_append",
    "instruction": "Make 'log.txt' append-only",
    "linux": "chattr +a log.txt",
    "windows_cmd": "echo N/A on Windows",
    "mac": "chflags uappnd log.txt",
    "difficulty": "advanced",
    "tags": [
      "chattr",
      "append-only",
      "protect"
    ]
  },
  {
    "id": "perm_comp_012",
    "category": "permissions",
    "subcategory": "lsattr",
    "instruction": "List file attributes",
    "linux": "lsattr",
    "windows_cmd": "attrib",
    "mac": "ls -lO",
    "difficulty": "intermediate",
    "tags": [
      "attributes",
      "lsattr",
      "view"
    ]
  },
  {
    "id": "perm_comp_013",
    "category": "permissions",
    "subcategory": "sudo_nopasswd",
    "instruction": "Run a command with sudo without password (if configured)",
    "linux": "sudo -n ls",
    "windows_cmd": "runas /user:admin /savecred ls",
    "mac": "sudo -n ls",
    "difficulty": "intermediate",
    "tags": [
      "sudo",
      "auth",
      "admin"
    ]
  },
  {
    "id": "perm_comp_014",
    "category": "permissions",
    "subcategory": "groups_add",
    "instruction": "Add user 'john' to group 'docker'",
    "linux": "usermod -aG docker john",
    "windows_cmd": "net localgroup docker john /add",
    "mac": "dseditgroup -o edit -a john -t user docker",
    "difficulty": "advanced",
    "tags": [
      "groups",
      "user",
      "add"
    ]
  },
  {
    "id": "perm_comp_016",
    "category": "permissions",
    "subcategory": "find_perm_exact",
    "instruction": "Find files with exactly 644 permissions",
    "linux": "find . -perm 644",
    "windows_cmd": "echo Requires scripting to check ACLs exactly.",
    "mac": "find . -perm 644",
    "difficulty": "intermediate",
    "tags": [
      "find",
      "permissions",
      "exact"
    ]
  },
  {
    "id": "perm_comp_017",
    "category": "permissions",
    "subcategory": "take_own",
    "instruction": "Take ownership of 'file.txt'",
    "linux": "chown $USER file.txt",
    "windows_cmd": "takeown /f file.txt",
    "mac": "chown $USER file.txt",
    "difficulty": "intermediate",
    "tags": [
      "chown",
      "ownership",
      "takeown"
    ]
  },
  {
    "id": "perm_comp_018",
    "category": "permissions",
    "subcategory": "icacls_reset",
    "instruction": "Reset permissions on 'data' folder to defaults",
    "linux": "echo Manual reset required (chmod/chown).",
    "windows_cmd": "icacls data /reset /t",
    "mac": "echo Manual reset required.",
    "difficulty": "intermediate",
    "tags": [
      "permissions",
      "reset",
      "icacls"
    ]
  },
  {
    "id": "perm_comp_019",
    "category": "permissions",
    "subcategory": "find_writable",
    "instruction": "Find files writable by everyone",
    "linux": "find . -perm -o=w",
    "windows_cmd": "accesschk -w -s Everyone * (SysInternals)",
    "mac": "find . -perm -o=w",
    "difficulty": "advanced",
    "tags": [
      "find",
      "security",
      "writable"
    ]
  },
  {
    "id": "perm_comp_020",
    "category": "permissions",
    "subcategory": "chmod_symbolic",
    "instruction": "Add execute permission for all users on 'script.sh'",
    "linux": "chmod a+x script.sh",
    "windows_cmd": "icacls script.sh /grant Everyone:RX",
    "mac": "chmod a+x script.sh",
    "difficulty": "beginner",
    "tags": [
      "chmod",
      "execute",
      "symbolic"
    ]
  },
  {
    "id": "perm_comp_021",
    "category": "permissions",
    "subcategory": "newgrp",
    "instruction": "Log in to a new group 'devs'",
    "linux": "newgrp devs",
    "windows_cmd": "echo N/A",
    "mac": "newgrp devs",
    "difficulty": "intermediate",
    "tags": [
      "group",
      "login",
      "session"
    ]
  },
  {
    "id": "perm_comp_022",
    "category": "permissions",
    "subcategory": "visudo",
    "instruction": "Edit the sudoers file safely",
    "linux": "sudo visudo",
    "windows_cmd": "echo N/A",
    "mac": "sudo visudo",
    "difficulty": "intermediate",
    "tags": [
      "sudo",
      "config",
      "edit"
    ]
  },
  {
    "id": "perm_comp_023",
    "category": "permissions",
    "subcategory": "passwd_lock",
    "instruction": "Lock the password of user 'john'",
    "linux": "passwd -l john",
    "windows_cmd": "net user john /active:no",
    "mac": "pw policy -u john -setpolicy \"isDisabled=1\"",
    "difficulty": "advanced",
    "tags": [
      "user",
      "lock",
      "password"
    ]
  },
  {
    "id": "perm_comp_024",
    "category": "permissions",
    "subcategory": "passwd_expire",
    "instruction": "Force user 'john' to change password on next login",
    "linux": "passwd -e john",
    "windows_cmd": "net user john /logonpasswordchg:yes",
    "mac": "pw policy -u john -setpolicy \"newPasswordRequired=1\"",
    "difficulty": "advanced",
    "tags": [
      "password",
      "expire",
      "force"
    ]
  },
  {
    "id": "perm_comp_025",
    "category": "permissions",
    "subcategory": "gpasswd",
    "instruction": "Add user 'john' to group 'admins'",
    "linux": "gpasswd -a john admins",
    "windows_cmd": "net localgroup admins john /add",
    "mac": "dseditgroup -o edit -a john -t user admins",
    "difficulty": "intermediate",
    "tags": [
      "group",
      "add",
      "user"
    ]
  },
  {
    "id": "perm_comp_026",
    "category": "permissions",
    "subcategory": "find_nouser",
    "instruction": "Find files not owned by any user",
    "linux": "find / -nouser",
    "windows_cmd": "echo N/A",
    "mac": "find / -nouser",
    "difficulty": "advanced",
    "tags": [
      "find",
      "audit",
      "nouser"
    ]
  },
  {
    "id": "perm_comp_027",
    "category": "permissions",
    "subcategory": "chroot_jail",
    "instruction": "Setup a chroot jail (conceptual)",
    "linux": "chroot /jail /bin/bash",
    "windows_cmd": "echo N/A",
    "mac": "chroot /jail /bin/bash",
    "difficulty": "advanced",
    "tags": [
      "chroot",
      "jail",
      "security"
    ]
  },
  {
    "id": "perm_comp_028",
    "category": "permissions",
    "subcategory": "run_root",
    "instruction": "Open a root shell",
    "linux": "sudo -i",
    "windows_cmd": "runas /user:administrator cmd",
    "mac": "sudo -i",
    "difficulty": "beginner",
    "tags": [
      "root",
      "shell",
      "sudo"
    ]
  },
  {
    "id": "perm_comp_029",
    "category": "permissions",
    "subcategory": "selinux_status",
    "instruction": "Check SELinux status",
    "linux": "sestatus",
    "windows_cmd": "echo N/A",
    "mac": "echo N/A (SIP is different)",
    "difficulty": "intermediate",
    "tags": [
      "selinux",
      "status",
      "security"
    ]
  },
  {
    "id": "perm_comp_030",
    "category": "permissions",
    "subcategory": "apparmor_status",
    "instruction": "Check AppArmor status",
    "linux": "aa-status",
    "windows_cmd": "echo N/A",
    "mac": "echo N/A",
    "difficulty": "intermediate",
    "tags": [
      "apparmor",
      "status",
      "security"
    ]
  },
  {
    "id": "perm_comp_031",
    "category": "permissions",
    "subcategory": "attrib_hidden",
    "instruction": "Hide a file 'secret.txt'",
    "linux": "mv secret.txt .secret.txt",
    "windows_cmd": "attrib +h secret.txt",
    "mac": "chflags hidden secret.txt",
    "difficulty": "beginner",
    "tags": [
      "hidden",
      "attrib",
      "hide"
    ]
  },
  {
    "id": "perm_comp_032",
    "category": "permissions",
    "subcategory": "attrib_readonly",
    "instruction": "Make 'file.txt' read-only",
    "linux": "chmod -w file.txt",
    "windows_cmd": "attrib +r file.txt",
    "mac": "chmod -w file.txt",
    "difficulty": "beginner",
    "tags": [
      "readonly",
      "attrib",
      "chmod"
    ]
  },
  {
    "id": "perm_comp_033",
    "category": "permissions",
    "subcategory": "icacls_save",
    "instruction": "Save permission settings to a file",
    "linux": "getfacl -R . > permissions.bak",
    "windows_cmd": "icacls * /save aclfile /t",
    "mac": "echo Use script to save permissions.",
    "difficulty": "advanced",
    "tags": [
      "backup",
      "permissions",
      "acl"
    ]
  },
  {
    "id": "perm_comp_034",
    "category": "permissions",
    "subcategory": "icacls_restore",
    "instruction": "Restore permission settings from a file",
    "linux": "setfacl --restore=permissions.bak",
    "windows_cmd": "icacls . /restore aclfile",
    "mac": "echo N/A",
    "difficulty": "advanced",
    "tags": [
      "restore",
      "permissions",
      "acl"
    ]
  },
  {
    "id": "perm_comp_035",
    "category": "permissions",
    "subcategory": "chmod_octal",
    "instruction": "Set permissions to 750 (rwxr-x---)",
    "linux": "chmod 750 file",
    "windows_cmd": "echo Use icacls for fine-grained control.",
    "mac": "chmod 750 file",
    "difficulty": "intermediate",
    "tags": [
      "chmod",
      "octal",
      "permissions"
    ]
  },
  {
    "id": "perm_comp_036",
    "category": "permissions",
    "subcategory": "whoami_priv",
    "instruction": "Check if running as administrator/root",
    "linux": "id -u",
    "windows_cmd": "net session >nul 2>&1 && echo Admin || echo User",
    "mac": "id -u",
    "difficulty": "intermediate",
    "tags": [
      "check",
      "admin",
      "root"
    ]
  },
  {
    "id": "perm_comp_037",
    "category": "permissions",
    "subcategory": "runas_savecred",
    "instruction": "Run command as another user saving credentials",
    "linux": "echo N/A (sudo caches creds)",
    "windows_cmd": "runas /user:other /savecred cmd",
    "mac": "echo N/A",
    "difficulty": "intermediate",
    "tags": [
      "runas",
      "credentials",
      "auth"
    ]
  },
  {
    "id": "perm_comp_038",
    "category": "permissions",
    "subcategory": "ssh_agent",
    "instruction": "Start SSH agent",
    "linux": "eval $(ssh-agent -s)",
    "windows_cmd": "ssh-agent",
    "mac": "eval $(ssh-agent -s)",
    "difficulty": "intermediate",
    "tags": [
      "ssh",
      "agent",
      "auth"
    ]
  },
  {
    "id": "perm_comp_039",
    "category": "permissions",
    "subcategory": "ssh_add",
    "instruction": "Add key to SSH agent",
    "linux": "ssh-add ~/.ssh/id_rsa",
    "windows_cmd": "ssh-add %USERPROFILE%\\.ssh\\id_rsa",
    "mac": "ssh-add ~/.ssh/id_rsa",
    "difficulty": "intermediate",
    "tags": [
      "ssh",
      "add",
      "key"
    ]
  },
  {
    "id": "perm_comp_040",
    "category": "permissions",
    "subcategory": "polkit",
    "instruction": "List Polkit actions (Linux)",
    "linux": "pkaction",
    "windows_cmd": "echo N/A",
    "mac": "echo N/A",
    "difficulty": "advanced",
    "tags": [
      "polkit",
      "policy",
      "auth"
    ]
  },
  {
    "id": "perm_comp_041",
    "category": "permissions",
    "subcategory": "groups_list",
    "instruction": "List all groups on the system",
    "linux": "cat /etc/group",
    "windows_cmd": "net localgroup",
    "mac": "dscl . list /Groups",
    "difficulty": "intermediate",
    "tags": [
      "groups",
      "list",
      "system"
    ]
  },
  {
    "id": "perm_comp_042",
    "category": "permissions",
    "subcategory": "users_list",
    "instruction": "List all users on the system",
    "linux": "cat /etc/passwd",
    "windows_cmd": "net user",
    "mac": "dscl . list /Users",
    "difficulty": "intermediate",
    "tags": [
      "users",
      "list",
      "system"
    ]
  },
  {
    "id": "perm_comp_043",
    "category": "permissions",
    "subcategory": "lastlog",
    "instruction": "Check last login times for all users",
    "linux": "lastlog",
    "windows_cmd": "echo Check Event Viewer.",
    "mac": "last",
    "difficulty": "intermediate",
    "tags": [
      "log",
      "login",
      "users"
    ]
  },
  {
    "id": "perm_comp_044",
    "category": "permissions",
    "subcategory": "login_shell",
    "instruction": "Change user login shell to zsh",
    "linux": "chsh -s /bin/zsh",
    "windows_cmd": "echo N/A",
    "mac": "chsh -s /bin/zsh",
    "difficulty": "intermediate",
    "tags": [
      "shell",
      "user",
      "config"
    ]
  },
  {
    "id": "perm_comp_045",
    "category": "permissions",
    "subcategory": "fs_acl",
    "instruction": "Enable ACL support on filesystem (mount)",
    "linux": "mount -o remount,acl /",
    "windows_cmd": "echo NTFS supports ACL by default.",
    "mac": "echo APFS/HFS+ supports ACL by default.",
    "difficulty": "advanced",
    "tags": [
      "mount",
      "acl",
      "fs"
    ]
  },
  {
    "id": "perm_comp_046",
    "category": "permissions",
    "subcategory": "audit_pol",
    "instruction": "Configure audit policy (Windows)",
    "linux": "echo Use auditd.",
    "windows_cmd": "auditpol /set /category:\"System\" /success:enable",
    "mac": "echo Use auditd.",
    "difficulty": "advanced",
    "tags": [
      "audit",
      "policy",
      "security"
    ]
  },
  {
    "id": "perm_comp_047",
    "category": "permissions",
    "subcategory": "uac",
    "instruction": "Disable UAC (Registry)",
    "linux": "echo N/A",
    "windows_cmd": "reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /f",
    "mac": "echo N/A",
    "difficulty": "advanced",
    "tags": [
      "uac",
      "registry",
      "security"
    ]
  },
  {
    "id": "perm_comp_048",
    "category": "permissions",
    "subcategory": "sip",
    "instruction": "Check System Integrity Protection status (Mac)",
    "linux": "echo N/A",
    "windows_cmd": "echo N/A",
    "mac": "csrutil status",
    "difficulty": "advanced",
    "tags": [
      "sip",
      "security",
      "mac"
    ]
  },
  {
    "id": "perm_comp_049",
    "category": "permissions",
    "subcategory": "gatekeeper",
    "instruction": "Disable Gatekeeper (Mac)",
    "linux": "echo N/A",
    "windows_cmd": "echo N/A",
    "mac": "sudo spctl --master-disable",
    "difficulty": "advanced",
    "tags": [
      "gatekeeper",
      "security",
      "mac"
    ]
  },
  {
    "id": "perm_comp_050",
    "category": "permissions",
    "subcategory": "def_user",
    "instruction": "Set default user for WSL",
    "linux": "echo Configured in /etc/wsl.conf",
    "windows_cmd": "ubuntu config --default-user username",
    "mac": "echo N/A",
    "difficulty": "intermediate",
    "tags": [
      "wsl",
      "user",
      "config"
    ]
  }
]